{"metadata":{},"options":{"plugins":[{"key":"base$0$0","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"generateLetDeclarations":true,"enforceStrictMode":false}},{"key":"transform-meteor-dynamic-import","visitor":{"_exploded":{},"_verified":{},"CallExpression":{"enter":[null]}},"options":{}},{"key":"base$0$2","visitor":{"CallExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"MemberExpression":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true,"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"polyfill":false,"useBuiltIns":true}},{"key":"base$0$3","visitor":{"_exploded":{},"_verified":{},"PrivateName":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]}},"options":{"loose":true}},{"key":"base$0$4","visitor":{"Program":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"allowTopLevelThis":true,"strictMode":false,"loose":true}},{"key":"base$0$1$0","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"Program":{"enter":[null],"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","throwIfNamespace":true,"useBuiltIns":false}},{"key":"base$0$1$1","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$1","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$2","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$3","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"base$0$0$4","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$5","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$6","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]}},"options":{}},{"key":"base$0$0$7","visitor":{"_exploded":{},"_verified":{},"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"base$0$0$8","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]},"ImportDeclaration":{"enter":[null,null]},"ClassProperty":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"TypeCastExpression":{"enter":[null,null]},"CallExpression":{"enter":[null]},"OptionalCallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"ImportSpecifier":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"AnyTypeAnnotation":{"enter":[null]},"ArrayTypeAnnotation":{"enter":[null]},"BooleanTypeAnnotation":{"enter":[null]},"BooleanLiteralTypeAnnotation":{"enter":[null]},"NullLiteralTypeAnnotation":{"enter":[null]},"ClassImplements":{"enter":[null]},"DeclareClass":{"enter":[null]},"DeclareFunction":{"enter":[null]},"DeclareInterface":{"enter":[null]},"DeclareModule":{"enter":[null]},"DeclareModuleExports":{"enter":[null]},"DeclareTypeAlias":{"enter":[null]},"DeclareOpaqueType":{"enter":[null]},"DeclareVariable":{"enter":[null]},"DeclareExportDeclaration":{"enter":[null]},"DeclareExportAllDeclaration":{"enter":[null]},"DeclaredPredicate":{"enter":[null]},"ExistsTypeAnnotation":{"enter":[null]},"FunctionTypeAnnotation":{"enter":[null]},"FunctionTypeParam":{"enter":[null]},"GenericTypeAnnotation":{"enter":[null]},"InferredPredicate":{"enter":[null]},"InterfaceExtends":{"enter":[null]},"InterfaceDeclaration":{"enter":[null]},"InterfaceTypeAnnotation":{"enter":[null]},"IntersectionTypeAnnotation":{"enter":[null]},"MixedTypeAnnotation":{"enter":[null]},"EmptyTypeAnnotation":{"enter":[null]},"NullableTypeAnnotation":{"enter":[null]},"NumberLiteralTypeAnnotation":{"enter":[null]},"NumberTypeAnnotation":{"enter":[null]},"ObjectTypeAnnotation":{"enter":[null]},"ObjectTypeInternalSlot":{"enter":[null]},"ObjectTypeCallProperty":{"enter":[null]},"ObjectTypeIndexer":{"enter":[null]},"ObjectTypeProperty":{"enter":[null]},"ObjectTypeSpreadProperty":{"enter":[null]},"OpaqueType":{"enter":[null]},"QualifiedTypeIdentifier":{"enter":[null]},"StringLiteralTypeAnnotation":{"enter":[null]},"StringTypeAnnotation":{"enter":[null]},"ThisTypeAnnotation":{"enter":[null]},"TupleTypeAnnotation":{"enter":[null]},"TypeofTypeAnnotation":{"enter":[null]},"TypeAlias":{"enter":[null]},"TypeAnnotation":{"enter":[null]},"TypeParameter":{"enter":[null]},"TypeParameterDeclaration":{"enter":[null]},"TypeParameterInstantiation":{"enter":[null]},"UnionTypeAnnotation":{"enter":[null]},"Variance":{"enter":[null]},"VoidTypeAnnotation":{"enter":[null]},"ExportAllDeclaration":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]}},"options":{}},{"key":"base$0$0$9","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$10","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}}],"presets":[],"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/home/blackstoneteam/repos/viralizing-web/app/imports/modules/accounts/ui/components/invite/share.jsx","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining","pipelineOperator","throwExpressions","dynamicImport","classProperties","classPrivateProperties","jsx",["flow",{}],"asyncGenerators","objectRestSpread","objectRestSpread",["flow",{}],"asyncGenerators"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"strictMode":false},"sourceFileName":"imports/modules/accounts/ui/components/invite/share.jsx","filename":"/home/blackstoneteam/repos/viralizing-web/app/imports/modules/accounts/ui/components/invite/share.jsx","passPerPreset":false,"envName":"development","cwd":"/home/blackstoneteam/repos/viralizing-web/app","root":"/home/blackstoneteam/repos/viralizing-web/app","generatorOpts":{"filename":"/home/blackstoneteam/repos/viralizing-web/app/imports/modules/accounts/ui/components/invite/share.jsx","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"imports/modules/accounts/ui/components/invite/share.jsx"}},"code":"var _interopRequireDefault = require(\"@babel/runtime/helpers/builtin/interopRequireDefault\");\n\nvar _objectSpread2 = _interopRequireDefault(require(\"@babel/runtime/helpers/builtin/objectSpread\"));\n\nlet React;\nmodule.watch(require(\"react\"), {\n  default(v) {\n    React = v;\n  }\n\n}, 0);\nlet swal;\nmodule.watch(require(\"sweetalert2\"), {\n  default(v) {\n    swal = v;\n  }\n\n}, 1);\nlet Translate, I18n;\nmodule.watch(require(\"react-redux-i18n\"), {\n  Translate(v) {\n    Translate = v;\n  },\n\n  I18n(v) {\n    I18n = v;\n  }\n\n}, 2);\nlet Tooltip, OverlayTrigger;\nmodule.watch(require(\"react-bootstrap\"), {\n  Tooltip(v) {\n    Tooltip = v;\n  },\n\n  OverlayTrigger(v) {\n    OverlayTrigger = v;\n  }\n\n}, 3);\nlet SocialAvatar;\nmodule.watch(require(\"../../../../core/ui/components/social-avatar\"), {\n  default(v) {\n    SocialAvatar = v;\n  }\n\n}, 4);\nlet notie;\nmodule.watch(require(\"notie\"), {\n  default(v) {\n    notie = v;\n  }\n\n}, 5);\n\nlet getTranslation = key => {\n  return \"Accounts.edit.tabs.settings.form.invite.\" + key;\n};\n\nclass AccountShares extends React.Component {\n  constructor() {\n    super();\n    this.state = {\n      email: \"\"\n    };\n    this.updateEmail = this.updateEmail.bind(this);\n    this.sendInvite = this.sendInvite.bind(this);\n    this.deleteInvite = this.deleteInvite.bind(this);\n    this.removeShare = this.removeShare.bind(this);\n  }\n\n  removeShare(share) {\n    let component = this;\n    return function () {\n      swal({\n        title: I18n.t(getTranslation(\"sent.delete.confirm.title\")),\n        text: I18n.t(getTranslation(\"sent.delete.confirm.description\")),\n        type: \"warning\",\n        showCancelButton: true,\n        confirmButtonText: I18n.t(getTranslation(\"sent.delete.confirm.confirm\")),\n        cancelButtonText: I18n.t(getTranslation(\"sent.delete.confirm.cancel\"))\n      }).then(function () {\n        let newShares = [...component.props.input.value];\n        let indexOf = newShares.indexOf(share);\n        newShares.splice(indexOf, 1);\n        component.props.input.onChange(newShares);\n      });\n    };\n  }\n\n  updateEmail(e) {\n    let val = e.target.value;\n    let newState = (0, _objectSpread2.default)({}, this.state);\n    newState.email = val;\n    this.setState(newState);\n  }\n\n  validateEmail(email) {\n    let re = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n    return re.exec(email) ? true : false;\n  }\n\n  sendInvite() {\n    let {\n      email\n    } = this.state;\n\n    if (!this.validateEmail(email)) {\n      notie.alert(3, I18n.t(getTranslation(\"error.invalid\")), 3);\n      return;\n    }\n\n    if (email === Meteor.user().emails[0].address) {\n      notie.alert(3, I18n.t(getTranslation(\"error.self\")), 3);\n      return;\n    }\n\n    let newInvite = {\n      email,\n      account: this.props.account._id,\n      type: \"share\"\n    };\n    let component = this;\n    Meteor.call(\"account-invite-create\", newInvite, function (err, res) {\n      if (err) {\n        if (err.error === 500) {\n          err.error = I18n.t(getTranslation(\"error.failed\"));\n        }\n\n        notie.alert(3, err.reason || err.error, 3);\n        return;\n      }\n\n      component.props.refetch({\n        accountID: component.props.account._id\n      });\n      component.setState({\n        form: false,\n        email: ''\n      });\n      swal(I18n.t(getTranslation(\"success.title\")), I18n.t(getTranslation(\"success.description\")), \"success\");\n    });\n  }\n\n  deleteInvite(invite) {\n    let component = this;\n    let {\n      account\n    } = this.props;\n    return function () {\n      swal({\n        title: I18n.t(getTranslation(\"sent.delete.confirm.title\")),\n        text: I18n.t(getTranslation(\"sent.delete.confirm.description\")),\n        type: \"warning\",\n        showCancelButton: true,\n        confirmButtonText: I18n.t(getTranslation(\"sent.delete.confirm.confirm\")),\n        cancelButtonText: I18n.t(getTranslation(\"sent.delete.confirm.cancel\"))\n      }).then(function () {\n        Meteor.call(\"account-invite-delete\", invite, account._id, function (err, res) {\n          if (err) {\n            notie.alert(3, I18n.t(getTranslation(\"sent.error\")), 3);\n            return;\n          }\n\n          component.props.refetch({\n            accountID: account._id\n          });\n          notie.alert(1, I18n.t(getTranslation(\"sent.success\")), 3);\n        });\n      });\n    };\n  }\n\n  tooltipContent(content) {\n    return React.createElement(Tooltip, {\n      id: \"tooltip_content\"\n    }, content);\n  }\n\n  render() {\n    let {\n      invites,\n      account,\n      isOwner,\n      isManager\n    } = this.props;\n\n    if (!isManager && !isOwner) {\n      return React.createElement(\"div\", null);\n    }\n\n    let shares = this.props.input.value;\n    return React.createElement(\"div\", {\n      className: \"row\"\n    }, React.createElement(\"div\", {\n      className: \"col-md-12\"\n    }, React.createElement(\"h5\", null, React.createElement(Translate, {\n      value: getTranslation(\"shares.title\")\n    }))), React.createElement(\"div\", {\n      className: \"col-md-9\"\n    }, shares && account.shares.length !== 0 && React.createElement(\"div\", {\n      className: \"form-group\"\n    }, React.createElement(\"label\", {\n      htmlFor: \"sharedWith\"\n    }, React.createElement(Translate, {\n      value: getTranslation(\"shares.current\")\n    })), React.createElement(\"ul\", {\n      className: \"list-group list-group-full\"\n    }, shares.map(account => React.createElement(\"li\", {\n      className: \"list-group-item\",\n      key: account._id\n    }, React.createElement(\"div\", {\n      className: \"media\"\n    }, React.createElement(\"div\", {\n      className: \"media-left\"\n    }, React.createElement(\"a\", {\n      className: \"avatar\",\n      href: \"javascript:void(0)\"\n    }, React.createElement(\"img\", {\n      className: \"img-fluid\",\n      src: account.profile.avatar,\n      alt: \"...\"\n    }))), React.createElement(\"div\", {\n      className: \"media-body\"\n    }, React.createElement(\"h4\", {\n      className: \"media-heading\"\n    }, (account.profile.name || \"\") + \" \" + (account.profile.lastName || \"\")), React.createElement(\"small\", null, account.emails ? account.emails[0].address : \"-\")), React.createElement(\"div\", {\n      className: \"media-right\"\n    }, React.createElement(OverlayTrigger, {\n      placement: \"top\",\n      overlay: this.tooltipContent(React.createElement(Translate, {\n        value: getTranslation(\"sent.delete.label\")\n      }))\n    }, React.createElement(\"i\", {\n      className: \"icon wb-trash\",\n      \"aria-hidden\": \"true\",\n      onClick: this.removeShare(account)\n    })))))))), React.createElement(\"div\", {\n      className: \"row\"\n    }, React.createElement(\"div\", {\n      className: \"col-md-8\"\n    }, React.createElement(\"div\", {\n      className: \"form-group\"\n    }, React.createElement(\"label\", {\n      htmlFor: \"informationName\"\n    }, React.createElement(Translate, {\n      value: getTranslation(\"shares.form.title\")\n    })), React.createElement(\"input\", {\n      type: \"text\",\n      className: \"form-control\",\n      placeholder: I18n.t(getTranslation(\"placeholder\")),\n      value: this.state.email,\n      onChange: this.updateEmail\n    }))), React.createElement(\"div\", {\n      className: \"col-md-4\"\n    }, React.createElement(\"a\", {\n      className: \"btn btn-primary\",\n      style: {\n        marginTop: \"24px\"\n      },\n      onClick: this.sendInvite\n    }, React.createElement(Translate, {\n      value: getTranslation(\"send\")\n    }))))), invites && invites.length > 0 && React.createElement(\"div\", {\n      className: \"col-md-8\"\n    }, React.createElement(\"div\", {\n      className: \"form-group\"\n    }, React.createElement(\"label\", {\n      htmlFor: \"sharedWith\"\n    }, React.createElement(Translate, {\n      value: getTranslation(\"shares.pending\")\n    })), invites.map(invite => React.createElement(\"div\", {\n      className: \"input-group\",\n      key: invite._id,\n      style: {\n        marginBottom: \"25px\"\n      }\n    }, React.createElement(\"input\", {\n      type: \"text\",\n      className: \"form-control\",\n      defaultValue: invite.email + \" (\" + I18n.t(getTranslation(\"status.\" + invite.status)) + \")\",\n      disabled: true\n    }), React.createElement(\"span\", {\n      className: \"input-group-btn\"\n    }, React.createElement(\"a\", {\n      className: \"btn btn-primary\"\n    }, React.createElement(OverlayTrigger, {\n      placement: \"top\",\n      overlay: this.tooltipContent(React.createElement(Translate, {\n        value: getTranslation(\"sent.delete.label\")\n      }))\n    }, React.createElement(\"i\", {\n      className: \"icon wb-trash\",\n      \"aria-hidden\": \"true\",\n      onClick: this.deleteInvite(invite)\n    })))))))));\n  }\n\n}\n\nmodule.exportDefault(AccountShares);","map":{"version":3,"sources":["imports/modules/accounts/ui/components/invite/share.jsx"],"names":["React","module","watch","require","default","v","swal","Translate","I18n","Tooltip","OverlayTrigger","SocialAvatar","notie","getTranslation","key","AccountShares","Component","constructor","state","email","updateEmail","bind","sendInvite","deleteInvite","removeShare","share","component","title","t","text","type","showCancelButton","confirmButtonText","cancelButtonText","then","newShares","props","input","value","indexOf","splice","onChange","e","val","target","newState","setState","validateEmail","re","exec","alert","Meteor","user","emails","address","newInvite","account","_id","call","err","res","error","reason","refetch","accountID","form","invite","tooltipContent","content","render","invites","isOwner","isManager","shares","length","map","profile","avatar","name","lastName","marginTop","marginBottom","status","exportDefault"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport swal from \"sweetalert2\";\nimport {Translate, I18n} from \"react-redux-i18n\";\nimport {Tooltip, OverlayTrigger} from \"react-bootstrap\";\nimport SocialAvatar from \"../../../../core/ui/components/social-avatar\";\nimport notie from \"notie\";\n\nlet getTranslation = (key) => {\n    return \"Accounts.edit.tabs.settings.form.invite.\" + key;\n};\n\nclass AccountShares extends React.Component {\n    constructor() {\n        super();\n\n        this.state = {\n            email: \"\"\n        };\n\n        this.updateEmail = this.updateEmail.bind(this);\n        this.sendInvite = this.sendInvite.bind(this);\n        this.deleteInvite = this.deleteInvite.bind(this);\n        this.removeShare = this.removeShare.bind(this);\n    }\n\n    removeShare(share) {\n        let component=this;\n        return function(){\n            swal({\n                title: I18n.t(getTranslation(\"sent.delete.confirm.title\")),\n                text: I18n.t(getTranslation(\"sent.delete.confirm.description\")),\n                type: \"warning\",\n                showCancelButton: true,\n                confirmButtonText: I18n.t(getTranslation(\"sent.delete.confirm.confirm\")),\n                cancelButtonText: I18n.t(getTranslation(\"sent.delete.confirm.cancel\"))\n            }).then(function () {\n                let newShares=[...component.props.input.value];\n                let indexOf=newShares.indexOf(share);\n                newShares.splice(indexOf,1);\n                component.props.input.onChange(newShares)\n            });\n        }\n    }\n\n    updateEmail(e) {\n        let val = e.target.value;\n        let newState = {...this.state};\n        newState.email = val;\n        this.setState(newState);\n    }\n\n    validateEmail(email) {\n        let re = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n        return re.exec(email) ? true : false\n    }\n\n    sendInvite() {\n        let {email}=this.state;\n        if (!this.validateEmail(email)) {\n            notie.alert(3, I18n.t(getTranslation(\"error.invalid\")), 3)\n            return;\n        }\n        if (email === Meteor.user().emails[0].address) {\n            notie.alert(3, I18n.t(getTranslation(\"error.self\")), 3);\n            return;\n        }\n        let newInvite = {\n            email,\n            account: this.props.account._id,\n            type: \"share\"\n        };\n        let component = this;\n        Meteor.call(\"account-invite-create\", newInvite, function (err, res) {\n            if (err) {\n                if (err.error === 500) {\n                    err.error = I18n.t(getTranslation(\"error.failed\"));\n                }\n                notie.alert(3, err.reason || err.error, 3);\n                return\n            }\n            component.props.refetch({\n                accountID: component.props.account._id\n            });\n\n\n            component.setState({form: false, email:''});\n            swal(\n                I18n.t(getTranslation(\"success.title\")),\n                I18n.t(getTranslation(\"success.description\")),\n                \"success\"\n            );\n\n        });\n    }\n\n    deleteInvite(invite) {\n        let component = this;\n        let {account}=this.props;\n        return function () {\n            swal({\n                title: I18n.t(getTranslation(\"sent.delete.confirm.title\")),\n                text: I18n.t(getTranslation(\"sent.delete.confirm.description\")),\n                type: \"warning\",\n                showCancelButton: true,\n                confirmButtonText: I18n.t(getTranslation(\"sent.delete.confirm.confirm\")),\n                cancelButtonText: I18n.t(getTranslation(\"sent.delete.confirm.cancel\"))\n            }).then(function () {\n                Meteor.call(\"account-invite-delete\", invite, account._id, function (err, res) {\n                    if (err) {\n                        notie.alert(3, I18n.t(getTranslation(\"sent.error\")), 3);\n                        return\n                    }\n                    component.props.refetch({\n                        accountID: account._id\n                    });\n                    notie.alert(1, I18n.t(getTranslation(\"sent.success\")), 3);\n                })\n            })\n        };\n    }\n\n    tooltipContent(content) {\n        return <Tooltip id=\"tooltip_content\">{content}</Tooltip>\n    }\n\n    render() {\n        let {invites, account, isOwner, isManager}=this.props;\n        if (!isManager && !isOwner) {\n            return <div/>\n        }\n        let shares=this.props.input.value;\n        return (\n            <div className=\"row\">\n                <div className=\"col-md-12\">\n                    <h5><Translate value={getTranslation(\"shares.title\")}/></h5>\n                </div>\n                <div className=\"col-md-9\">\n                    {(shares && account.shares.length !== 0) && (\n                        <div className=\"form-group\">\n                            <label htmlFor=\"sharedWith\">\n                                <Translate value={getTranslation(\"shares.current\")}/>\n                            </label>\n                            <ul className=\"list-group list-group-full\">\n                                {shares.map((account) => (\n                                    <li className=\"list-group-item\" key={account._id}>\n                                        <div className=\"media\">\n                                            <div className=\"media-left\">\n                                                <a className=\"avatar\" href=\"javascript:void(0)\">\n                                                    <img className=\"img-fluid\" src={account.profile.avatar} alt=\"...\"/>\n                                                </a>\n                                            </div>\n                                            <div className=\"media-body\">\n                                                <h4 className=\"media-heading\">{(account.profile.name || \"\") + \" \" + (account.profile.lastName || \"\")}</h4>\n                                                <small>{account.emails ? account.emails[0].address : \"-\"}</small>\n                                            </div>\n                                            <div className=\"media-right\">\n                                                <OverlayTrigger placement=\"top\"\n                                                                overlay={this.tooltipContent(<Translate\n                                                                    value={getTranslation(\"sent.delete.label\")}/>)}>\n                                                    <i className=\"icon wb-trash\" aria-hidden=\"true\"\n                                                       onClick={this.removeShare(account)}/>\n                                                </OverlayTrigger>\n                                            </div>\n                                        </div>\n                                    </li>\n                                ))}\n                            </ul>\n                        </div>\n                    )}\n\n                    <div className=\"row\">\n                        <div className=\"col-md-8\">\n                            <div className=\"form-group\">\n                                <label htmlFor=\"informationName\">\n                                    <Translate value={getTranslation(\"shares.form.title\")}/>\n                                </label>\n                                <input type=\"text\" className=\"form-control\"\n                                       placeholder={I18n.t(getTranslation(\"placeholder\"))}\n                                       value={this.state.email}\n                                       onChange={this.updateEmail}/>\n                            </div>\n                        </div>\n                        <div className=\"col-md-4\">\n                            <a className=\"btn btn-primary\" style={{marginTop: \"24px\"}} onClick={this.sendInvite}>\n                                <Translate value={getTranslation(\"send\")}/>\n                            </a>\n                        </div>\n                    </div>\n                </div>\n\n\n                {(invites && invites.length > 0) && (\n                    <div className=\"col-md-8\">\n                        <div className=\"form-group\">\n                            <label htmlFor=\"sharedWith\">\n                                <Translate value={getTranslation(\"shares.pending\")}/>\n                            </label>\n\n                            {invites.map((invite) => (\n                                <div className=\"input-group\" key={invite._id} style={{marginBottom: \"25px\"}}>\n                                    <input type=\"text\" className=\"form-control\"\n                                           defaultValue={invite.email + \" (\" + I18n.t(getTranslation(\"status.\" + invite.status)) + \")\"}\n                                           disabled/>\n                                    <span className=\"input-group-btn\">\n                                    <a className=\"btn btn-primary\">\n                                        <OverlayTrigger placement=\"top\"\n                                                        overlay={this.tooltipContent(<Translate\n                                                            value={getTranslation(\"sent.delete.label\")}/>)}>\n                                                <i className=\"icon wb-trash\" aria-hidden=\"true\"\n                                                   onClick={this.deleteInvite(invite)}/>\n                                            </OverlayTrigger>\n                                    </a>\n                                </span>\n                                </div>\n                            ))}\n                        </div>\n                    </div>\n                )}\n            </div>\n        )\n    }\n}\n\nexport default AccountShares;\n"]},"sourceType":"script","hash":"03f4e5998b91234df9a177cbc083df61e157a21c"}
