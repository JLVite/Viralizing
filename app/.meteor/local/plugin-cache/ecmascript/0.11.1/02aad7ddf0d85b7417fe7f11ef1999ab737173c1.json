{"metadata":{},"options":{"plugins":[{"key":"base$1$0","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"Program":{"enter":[null],"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","throwIfNamespace":true,"useBuiltIns":false}},{"key":"base$1$1","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"generateLetDeclarations":true,"enforceStrictMode":false}},{"key":"base$0$1","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$2","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]},"ImportDeclaration":{"enter":[null,null]},"ClassProperty":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"TypeCastExpression":{"enter":[null,null]},"CallExpression":{"enter":[null]},"OptionalCallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"ImportSpecifier":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"AnyTypeAnnotation":{"enter":[null]},"ArrayTypeAnnotation":{"enter":[null]},"BooleanTypeAnnotation":{"enter":[null]},"BooleanLiteralTypeAnnotation":{"enter":[null]},"NullLiteralTypeAnnotation":{"enter":[null]},"ClassImplements":{"enter":[null]},"DeclareClass":{"enter":[null]},"DeclareFunction":{"enter":[null]},"DeclareInterface":{"enter":[null]},"DeclareModule":{"enter":[null]},"DeclareModuleExports":{"enter":[null]},"DeclareTypeAlias":{"enter":[null]},"DeclareOpaqueType":{"enter":[null]},"DeclareVariable":{"enter":[null]},"DeclareExportDeclaration":{"enter":[null]},"DeclareExportAllDeclaration":{"enter":[null]},"DeclaredPredicate":{"enter":[null]},"ExistsTypeAnnotation":{"enter":[null]},"FunctionTypeAnnotation":{"enter":[null]},"FunctionTypeParam":{"enter":[null]},"GenericTypeAnnotation":{"enter":[null]},"InferredPredicate":{"enter":[null]},"InterfaceExtends":{"enter":[null]},"InterfaceDeclaration":{"enter":[null]},"InterfaceTypeAnnotation":{"enter":[null]},"IntersectionTypeAnnotation":{"enter":[null]},"MixedTypeAnnotation":{"enter":[null]},"EmptyTypeAnnotation":{"enter":[null]},"NullableTypeAnnotation":{"enter":[null]},"NumberLiteralTypeAnnotation":{"enter":[null]},"NumberTypeAnnotation":{"enter":[null]},"ObjectTypeAnnotation":{"enter":[null]},"ObjectTypeInternalSlot":{"enter":[null]},"ObjectTypeCallProperty":{"enter":[null]},"ObjectTypeIndexer":{"enter":[null]},"ObjectTypeProperty":{"enter":[null]},"ObjectTypeSpreadProperty":{"enter":[null]},"OpaqueType":{"enter":[null]},"QualifiedTypeIdentifier":{"enter":[null]},"StringLiteralTypeAnnotation":{"enter":[null]},"StringTypeAnnotation":{"enter":[null]},"ThisTypeAnnotation":{"enter":[null]},"TupleTypeAnnotation":{"enter":[null]},"TypeofTypeAnnotation":{"enter":[null]},"TypeAlias":{"enter":[null]},"TypeAnnotation":{"enter":[null]},"TypeParameter":{"enter":[null]},"TypeParameterDeclaration":{"enter":[null]},"TypeParameterInstantiation":{"enter":[null]},"UnionTypeAnnotation":{"enter":[null]},"Variance":{"enter":[null]},"VoidTypeAnnotation":{"enter":[null]},"ExportAllDeclaration":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]}},"options":{}},{"key":"base$0$3","visitor":{"CallExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"MemberExpression":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true,"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"polyfill":false,"useBuiltIns":true}},{"key":"base$0$4","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$5","visitor":{"_exploded":{},"_verified":{},"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-meteor-async-await","visitor":{"AwaitExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ObjectMethod":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"ClassMethod":{"exit":[null]}},"options":{"useNativeAsyncAwait":false}},{"key":"transform-meteor-dynamic-import","visitor":{"_exploded":{},"_verified":{},"CallExpression":{"enter":[null]}},"options":{}},{"key":"base$0$8","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"base$0$9","visitor":{"Program":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"allowTopLevelThis":true,"strictMode":false,"loose":true}},{"key":"base$0$10","visitor":{"_exploded":{},"_verified":{},"PrivateName":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]}},"options":{"loose":true}}],"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/home/blackstoneteam/repos/viralizing-web/app/imports/modules/facebook/server/post-create.jsx","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining","pipelineOperator","throwExpressions","jsx",["flow",{}],["flow",{}],"objectRestSpread","objectRestSpread","dynamicImport","asyncGenerators","classProperties","classPrivateProperties"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"strictMode":false},"sourceFileName":"imports/modules/facebook/server/post-create.jsx","filename":"/home/blackstoneteam/repos/viralizing-web/app/imports/modules/facebook/server/post-create.jsx","passPerPreset":false,"envName":"development","cwd":"/home/blackstoneteam/repos/viralizing-web/app","root":"/home/blackstoneteam/repos/viralizing-web/app","presets":[],"generatorOpts":{"filename":"/home/blackstoneteam/repos/viralizing-web/app/imports/modules/facebook/server/post-create.jsx","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"imports/modules/facebook/server/post-create.jsx"}},"code":"let FacebookConnection;\nmodule.watch(require(\"./connection\"), {\n  default(v) {\n    FacebookConnection = v;\n  }\n\n}, 0);\n\nlet request = require('request').defaults({\n  encoding: null\n});\n\nMeteor.methods({\n  \"facebook-post-create\": function (connection, postData, callback) {\n    let client = FacebookConnection(connection.accessToken);\n\n    if (client) {\n      let postMessage = function (post) {\n        return client.api(\"me/feed\", \"post\", {\n          message: post.status\n        }, function (res) {\n          if (!res || res.error) {\n            console.log(!res ? \"error occurred\" : res.error);\n            return;\n          }\n\n          console.log('Post Id: ' + res.id);\n\n          if (callback) {\n            callback();\n          }\n        });\n      },\n          postImage = function (post) {\n        return request.get(post.media, function (error, response, body) {\n          if (!error && response.statusCode == 200) {\n            return client.api(\"me/photos\", \"post\", {\n              url: post.media,\n              caption: post.status\n            }, function (res) {\n              if (!res || res.error) {\n                console.log(!res ? 'error occurred' : res.error);\n                return;\n              }\n\n              console.log('Post Id: ' + res.post_id);\n\n              if (callback) {\n                callback();\n              }\n            });\n          }\n        });\n      };\n      /*console.log(\"FACEBOOK_POST_DATE:\", post.date, \"_CURRENT_TIME:\", new Date());*/\n\n\n      let message = {\n        status: postData.message //+ \"Scheduled at: \" + moment(post.date).format(\"h:m A\") + \" Posted at: \" + moment(new Date()).format(\"h:m A\")\n\n      };\n\n      if (postData.location) {\n        message.lat = postData.location[0];\n        message.long = postData.location[1];\n        message.display_coordinates = true;\n      }\n\n      if (postData.media) {\n        message.media = postData.media;\n      }\n\n      let query;\n\n      if (message.media) {\n        query = postImage(message);\n      } else {\n        query = postMessage(message);\n      }\n\n      return query;\n    }\n  }\n});","map":{"version":3,"sources":["imports/modules/facebook/server/post-create.jsx"],"names":["FacebookConnection","module","watch","require","default","v","request","defaults","encoding","Meteor","methods","connection","postData","callback","client","accessToken","postMessage","post","api","message","status","res","error","console","log","id","postImage","get","media","response","body","statusCode","url","caption","post_id","location","lat","long","display_coordinates","query"],"mappings":"AAAA,IAAIA,kBAAJ;AAAuBC,OAAOC,KAAP,CAAaC,QAAQ,cAAR,CAAb,EAAqC;AAACC,UAAQC,CAAR,EAAU;AAACL,yBAAmBK,CAAnB;AAAqB;;AAAjC,CAArC,EAAwE,CAAxE;;AAEvB,IAAIC,UAAUH,QAAQ,SAAR,EAAmBI,QAAnB,CAA4B;AAACC,YAAU;AAAX,CAA5B,CAAd;;AAEAC,OAAOC,OAAP,CAAe;AACX,0BAAwB,UAAUC,UAAV,EAAsBC,QAAtB,EAAgCC,QAAhC,EAA0C;AAC9D,QAAIC,SAASd,mBAAmBW,WAAWI,WAA9B,CAAb;;AAEA,QAAID,MAAJ,EAAY;AACR,UAAIE,cAAc,UAAUC,IAAV,EAAgB;AAC1B,eAAOH,OAAOI,GAAP,CAAW,SAAX,EAAsB,MAAtB,EAA8B;AAACC,mBAASF,KAAKG;AAAf,SAA9B,EAAsD,UAAUC,GAAV,EAAe;AACxE,cAAI,CAACA,GAAD,IAAQA,IAAIC,KAAhB,EAAuB;AACnBC,oBAAQC,GAAR,CAAY,CAACH,GAAD,GAAO,gBAAP,GAA0BA,IAAIC,KAA1C;AACA;AACH;;AACDC,kBAAQC,GAAR,CAAY,cAAcH,IAAII,EAA9B;;AACA,cAAIZ,QAAJ,EAAc;AACVA;AACH;AACJ,SATM,CAAP;AAUH,OAXL;AAAA,UAYIa,YAAY,UAAUT,IAAV,EAAgB;AACxB,eAAOX,QAAQqB,GAAR,CAAYV,KAAKW,KAAjB,EAAwB,UAAUN,KAAV,EAAiBO,QAAjB,EAA2BC,IAA3B,EAAiC;AAC5D,cAAI,CAACR,KAAD,IAAUO,SAASE,UAAT,IAAuB,GAArC,EAA0C;AACtC,mBAAOjB,OAAOI,GAAP,CAAW,WAAX,EAAwB,MAAxB,EAAgC;AACnCc,mBAAKf,KAAKW,KADyB;AAEnCK,uBAAShB,KAAKG;AAFqB,aAAhC,EAGJ,UAAUC,GAAV,EAAe;AACd,kBAAI,CAACA,GAAD,IAAQA,IAAIC,KAAhB,EAAuB;AACnBC,wBAAQC,GAAR,CAAY,CAACH,GAAD,GAAO,gBAAP,GAA0BA,IAAIC,KAA1C;AACA;AACH;;AACDC,sBAAQC,GAAR,CAAY,cAAcH,IAAIa,OAA9B;;AACA,kBAAIrB,QAAJ,EAAc;AACVA;AACH;AACJ,aAZM,CAAP;AAaH;AACJ,SAhBM,CAAP;AAiBH,OA9BL;AAiCA;;;AACA,UAAIM,UAAU;AACVC,gBAAQR,SAASO,OADP,CACe;;AADf,OAAd;;AAIA,UAAIP,SAASuB,QAAb,EAAuB;AACnBhB,gBAAQiB,GAAR,GAAcxB,SAASuB,QAAT,CAAkB,CAAlB,CAAd;AACAhB,gBAAQkB,IAAR,GAAezB,SAASuB,QAAT,CAAkB,CAAlB,CAAf;AACAhB,gBAAQmB,mBAAR,GAA8B,IAA9B;AACH;;AACD,UAAI1B,SAASgB,KAAb,EAAoB;AAChBT,gBAAQS,KAAR,GAAgBhB,SAASgB,KAAzB;AACH;;AAED,UAAIW,KAAJ;;AAEA,UAAIpB,QAAQS,KAAZ,EAAmB;AACfW,gBAAQb,UAAUP,OAAV,CAAR;AACH,OAFD,MAEO;AACHoB,gBAAQvB,YAAYG,OAAZ,CAAR;AACH;;AAED,aAAOoB,KAAP;AACH;AACJ;AA9DU,CAAf","sourcesContent":["import FacebookConnection from \"./connection\";\n\nlet request = require('request').defaults({encoding: null});\n\nMeteor.methods({\n    \"facebook-post-create\": function (connection, postData, callback) {\n        let client = FacebookConnection(connection.accessToken);\n\n        if (client) {\n            let postMessage = function (post) {\n                    return client.api(\"me/feed\", \"post\", {message: post.status}, function (res) {\n                        if (!res || res.error) {\n                            console.log(!res ? \"error occurred\" : res.error);\n                            return;\n                        }\n                        console.log('Post Id: ' + res.id);\n                        if (callback) {\n                            callback();\n                        }\n                    });\n                },\n                postImage = function (post) {\n                    return request.get(post.media, function (error, response, body) {\n                        if (!error && response.statusCode == 200) {\n                            return client.api(\"me/photos\", \"post\", {\n                                url: post.media,\n                                caption: post.status\n                            }, function (res) {\n                                if (!res || res.error) {\n                                    console.log(!res ? 'error occurred' : res.error);\n                                    return;\n                                }\n                                console.log('Post Id: ' + res.post_id);\n                                if (callback) {\n                                    callback();\n                                }\n                            });\n                        }\n                    });\n                };\n\n\n            /*console.log(\"FACEBOOK_POST_DATE:\", post.date, \"_CURRENT_TIME:\", new Date());*/\n            let message = {\n                status: postData.message //+ \"Scheduled at: \" + moment(post.date).format(\"h:m A\") + \" Posted at: \" + moment(new Date()).format(\"h:m A\")\n            };\n\n            if (postData.location) {\n                message.lat = postData.location[0];\n                message.long = postData.location[1];\n                message.display_coordinates = true;\n            }\n            if (postData.media) {\n                message.media = postData.media;\n            }\n\n            let query;\n\n            if (message.media) {\n                query = postImage(message);\n            } else {\n                query = postMessage(message);\n            }\n\n            return query;\n        }\n    }\n});\n"]},"sourceType":"script","hash":"02aad7ddf0d85b7417fe7f11ef1999ab737173c1"}
